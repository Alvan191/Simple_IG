<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <title>Home Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-light bg-white border-bottom mb-4">
    <div class="container d-flex justify-content-end">
      <div class="d-flex align-items-center">
        <span class="me-2 fw-semibold">{{ .CurrentUser }}</span>
        <img src="https://ui-avatars.com/api/?name={{ .CurrentUser }}&background=0D6EFD&color=fff"
          class="rounded-circle" width="40" height="40">
      </div>
    </div>
  </nav>
  <div class="container mt-4">

    <h4>Buat Post</h4>

    <!-- FORM POST -->
    <form action="/insta" method="post">
      <textarea name="content" class="form-control mb-2" placeholder="Tulis postingan..." required></textarea>

      <button type="submit" class="btn btn-primary">
        Post
      </button>
    </form>

    <hr>

    <!--LIST POST-->
    {{ range .Posts }}
    <div class="card mb-3">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between">
          <h6 class="mb-0">{{ if .User }}{{ .User.Username }}{{ else }}Unknown{{ end }}</h6>
          <div class="dropdown">
            <button class="btn btn-sm btn-light" type="button" data-bs-toggle="dropdown"
              aria-expanded="false">&#8942;</button>
            <ul class="dropdown-menu dropdown-menu-end">
              {{ if eq .UserID $.CurrentUserID }}
              <li>
                <a href="/insta/{{ .ID }}/edit" class="dropdown-item">&#9999; Edit</a>
              </li>
              <li>
                <form action="/insta/{{ .ID }}/delete" method="post"
                  onsubmit="return confirm('Yakin ingin menghapus postingan ini?')">
                  <button type="submit" class="dropdown-item text-danger">&#128465; Delete</button>
                </form>
              </li>
              {{ end }}
              <li>
                <form action="" method="" onsubmit="return confirm('Laporkan postingan ini?')">
                  <button type="submit" class="dropdown-item text-warning">
                    ðŸš© Report
                  </button>
                </form>
              </li>

            </ul>
          </div>
        </div>
        <p>{{ .Content}}</p>
        <small class="text-muted">{{ .CreatedAt.Format "02 Jan 2006 15:04" }}</small>

        <!--Comment FORM-->
        <form action="/posts/{{ .ID}}/comments" method="post" class="mt-2">
          <textarea name="content" class="form-control mb-2" placeholder="Tulis Komentar....." required></textarea>
          <button type="submit" class="btn btn-sm btn-secondary">Reply</button>
        </form>

        <!--COMMENTS-->
        {{ range .Coments }}
        <div class="mt-2 ps-3 border-start">
          <strong>{{ .User.Username }}</strong>: {{ .Content }}
          <br><small class="text-muted">{{ .CreatedAt.Format "02 Jan 2006 15:04" }}</small>
        </div>
        {{ end }}

      </div>
    </div>
    {{ end }}

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


</body>

</html>